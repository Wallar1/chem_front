# More info about the docker-compose specs/format can be found here https://github.com/compose-spec/compose-spec/blob/master/spec.md

services:
    chem:
        environment:  # can just contain the env variables here
            - POSTGRES_USER=postgres
        command: /scripts/keep_running.sh
        image: 627023082830.dkr.ecr.us-west-1.amazonaws.com/chem:latest
        volumes:
            - .:/usr/app
            - /usr/app/node_modules
            - chem_volume:/home/
            - ./scripts:/scripts:delegated
        #    - <name of the volume>:<path to where the container is mounted in the container>:<options>
        build:
            context: ~/toyprojs/chem_front
            args:
                AWS_KEY: 
                AWS_SECRET: 
        # depends_on:
        #     - other_service_name
        ports:
            - "8080:8080"  # maps the ports
        networks:
            - mynet
        stdin_open: true
        tty: true  # -t in cli, used to get terminal connection to the container (connects stdin/out somehow)

# https://docs.docker.com/network/network-tutorial-standalone/
networks:
    mynet:
        driver: bridge
        # ipam:
        #     config:
        #         - subnet: 10.5.0.0/16
        #         - gateway: 10.5.0.1

volumes:
    chem_volume:
